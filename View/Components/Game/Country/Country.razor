@using Model.Entities.Regions
@using Model.Entities
@using Domain.Services
@using View.Services
@inject CountryPaths CountryPaths
@inject ActiveRegion ActiveRegion

@if (Region is not null){
    @if (Region.IsLandRegion()){
        @if (Owner.Type == ENation.Neutral){
            <path d="@CountryPaths[Region.Identifier]" class="svg_country @Owner.Name" style="fill: url(#neutral)" stroke="grey" stroke-width="2"/>
        }
        else{
            @if (ActiveRegion.Region == Region){
                <path d="@CountryPaths[Region.Identifier]" class="active_country svg_country @Owner.Name" fill="@Owner.Color" stroke="grey" stroke-width="2" @onclick="args => UpdateRegion(args)"/>
            }
            else{
                <path d="@CountryPaths[Region.Identifier]" class="svg_country @Owner.Name" fill="@Owner.Color" stroke="grey" stroke-width="2" @onclick="args => UpdateRegion(args)"/>
            }
        }
    }
    else{
        @if (ActiveRegion.Region == Region){
            <path d="@CountryPaths[Region.Identifier]" class="active_country svg_country seezone" style="fill: url(#water)" stroke="grey" stroke-width="1" @onclick="args => UpdateRegion(args)"/>
        }
        else{
            <path d="@CountryPaths[Region.Identifier]" class="svg_country seezone" style="fill: url(#water)" stroke="grey" stroke-width="1" @onclick="args => UpdateRegion(args)"/>
        }
    }
}

@code {

    [Parameter]
    public ARegion? Region { get; set; }

    [Parameter]
    public Nation Owner { get; set; } = new();

    private void UpdateRegion(MouseEventArgs args){
        if (args.ShiftKey){
            return;
        }
        if (Region is null) return;
        if (ActiveRegion.Region == Region){
            ActiveRegion.ClearRegion();
        }
        else{
            ActiveRegion.RefreshRegion(Region);
        }
    }

}