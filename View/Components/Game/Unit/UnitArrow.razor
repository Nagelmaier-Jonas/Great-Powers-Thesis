@using Model.Entities.Units.Abstract
@using System.Drawing
@using System.Text
@inject GameEngine GameEngine

@if (Unit is not null){
    <svg xmlns="http://www.w3.org/2000/svg">
        <defs>
            <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5"
                    markerWidth="6" markerHeight="6" orient="auto">
                <path d="M 0 0 L 10 5 L 0 10 z"/>
            </marker>
        </defs>
        <path d="@GetPath()" stroke="black" fill="none" marker-end="url(#arrow)"/>
    </svg>
}

@code {

    [Parameter]
    public AUnit? Unit { get; set; }

    private List<Point> Path { get; set; } = new();

    protected override async Task OnInitializedAsync(){
        if (Unit is null) return;
        var countries = await GameEngine.GetPathForUnit(Unit);
        foreach (var c in countries){
            Path.Add(new Point((int)c.PositionX, (int)c.PositionY));
        }
    }
    
    private string GetPath(){
        const string path = "";
        return Path.Aggregate(path, (current, p) => current + $"{p.X} {p.Y} ");
    }

}